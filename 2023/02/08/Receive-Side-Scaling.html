<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <!-- (1) Optimize for mobile versions: http://goo.gl/EOpFl -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- (1) force latest IE rendering engine: bit.ly/1c8EiC9 -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Azure VNET 라우팅</title>
  <meta name="description" content="RSS에 대해서 다시 자료를 보고 있는데10년전에도 Multiqueue NIC에 대해서 썼었다는 것을 발견했다.아 세월의 무상함이여.." />

  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@cwyang" />
    <meta name="twitter:title" content="Azure VNET 라우팅" />
    <meta name="twitter:image" content="http://cwyang.github.io/assets/images/cwyang2016.jpg" />
    
    <meta name="twitter:description"  content="RSS에 대해서 다시 자료를 보고 있는데10년전에도 Multiqueue NIC에 대해서 썼었다는 것을 발견했다.아 세월의 무상함이여.." />
    
  
  
  <meta property="og:site_name" content="양철웅의 DX 이야기" />
  <meta property="og:title" content="Azure VNET 라우팅"/>
  
  <meta property="og:description" content="RSS에 대해서 다시 자료를 보고 있는데10년전에도 Multiqueue NIC에 대해서 썼었다는 것을 발견했다.아 세월의 무상함이여.." />
  
  <meta property="og:image" content="http://cwyang.github.io/assets/images/cwyang2016.jpg" />
  <meta property="og:url" content="http://cwyang.github.io/2023/02/08/Receive-Side-Scaling.html" />
  <meta property="og:type" content="article" />
  <meta property="article:published_time" content="2023-02-08T20:00:00+09:00">

  <meta property="fb:app_id" content="596017104565491" />
  <meta name="naver-site-verification" content="cec40b2338ce973c5b5588326daed5c126a0c415" />

  <link rel="canonical" href="http://cwyang.github.io/2023/02/08/Receive-Side-Scaling.html"/>
  <link rel="shortcut icon" href="/assets/images/favicon.png" type="image/png"/>
  <link rel="stylesheet" href="//brick.a.ssl.fastly.net/Linux+Libertine:400,400i,700,700i/Open+Sans:400,400i,700,700i" />
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" />

  <link rel="stylesheet" type="text/css" href="/css/main.css?1689503527012810482" />
  <link rel="stylesheet" type="text/css" href="/css/nerd-fonts-generated.css" />
  <link rel="stylesheet" type="text/css" href="/css/asciinema-player.css" />
  <!-- <link rel="stylesheet" type="text/css" media="print" href="/css/print.css" />-->
  
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.16/webfont.js"></script>
  <script type="text/javascript">
    WebFont.load({
      custom: {
        families: ['Spoqa Han Sans'],
        urls: ['/css/spoqa-han-sans-font.css']
      }
    });
  </script>

  <script>
    var _mailChimpUrl = "";
  </script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-6183151-15', 'auto');
  ga('send', 'pageview');
</script>

</head>

  <body itemscope itemtype="http://schema.org/Article">
    <!-- header start -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-6183151-15', 'auto');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');
</script>

<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "https://connect.facebook.net/ko_KR/sdk.js#xfbml=1&version=v2.12&appId=596017104565491";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<a href="http://cwyang.github.io" class="logo-readium"><span class="logo" style="background-image: url(/assets/images/cwyang2016.jpg)"></span></a>
<meta name="naver-site-verification" content="c162847e57c5d356ce72f4c9b9e81bd5d57de196" />
<!-- header end -->

    <main class="content" role="main">
      <article class="post">
        
        <div class="noarticleimage">
          <div class="post-meta">
            <h1 class="post-title">
              Azure VNET 라우팅
              
            </h1>
            <div class="cf post-meta-text">
              <section class="share pull-right">
                <div class="fb-like" data-href="http://cwyang.github.io/2023/02/08/Receive-Side-Scaling.html" data-layout="button_count" data-action="like" data-show-faces="true" data-share="true"></div>
                
                  
                    <a class="icon-facebook" href="https://www.facebook.com/sharer.php?t=Azure+VNET+%EB%9D%BC%EC%9A%B0%ED%8C%85&amp;u=http://cwyang.github.io/2023/02/08/Receive-Side-Scaling"
                      onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
                    <i class="fa fa-facebook"></i><span class="hidden">facebook</span>
                    </a>
                  
                
                  
                    <a class="icon-twitter" href="http://twitter.com/share?text=Azure+VNET+%EB%9D%BC%EC%9A%B0%ED%8C%85&amp;url=http://cwyang.github.io/2023/02/08/Receive-Side-Scaling"
                      onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
                    <i class="fa fa-twitter"></i><span class="hidden">twitter</span>
                    </a>
                  
                
              </section>
              
              <div class="author-image" style="background-image: url(/assets/images/author.jpg)">Blog Logo</div>
              <h4 class="author-name" itemprop="author" itemscope itemtype="http://schema.org/Person">cwyang</h4>
              on
              <time datetime="2023-02-08T20:00:00+09:00">08 Feb 2023</time>
            </div>
          </div>
        </div>
        <br>
        <br>
        <br>
        
        <section class="post-content">
          <div class="post-reading">
            <span class="post-reading-time"></span> read
          </div>
          <a name="topofpage"></a>
          <p>RSS에 대해서 다시 자료를 보고 있는데
<a href="/2010/06/10/multiqueue-nic.html">10년전에도 Multiqueue NIC에 대해서 썼었다는 것을 발견했다.</a>
아 세월의 무상함이여..</p>

<p>각설하고, 여러 자료들을 바탕으로 RSS에 대해서 정리한다.</p>
<ul>
  <li><a href="https://www.kernel.org/doc/Documentation/networking/scaling.txt">Scaling in the Linux Networking Stack</a></li>
</ul>

<h2 id="rss">RSS</h2>

<p>패킷스트림을 분산하지 않고 처리하기는 어려운 시대가 되었다.
네트워크 인터페이스 카드(NIC)이 패킷을 메모리로 전달할 때,
큐를 여러개 두고 패킷을 분산하되 동일한 플로우에 대해서는 동일한 큐로 전달한다.
이를 Receive Side Scaling (RSS)라고 지칭한다.</p>

<p>보편적인 하드웨어 구현방법은 4-tuple (src/dst IP/port)에 대하여 128bucket 해시를 적용하고
해시 버켓에 대응되는 큐로 패킷을 전송하는 것이다.
주로 Toeplitz 해시값의 아래 7bit를 사용한다.</p>

<p>지능형 NIC은 단순 해시가 아닌 계산에 의한 큐 지정 기능을 지원하기도 한다.
<code class="language-plaintext highlighter-rouge">ethtool --config-ntuple</code> 을 참조한다.</p>

<p>Linux 커널에서 드라이버 구동시 num_queue를 지정할 수 있다.
CPU, 아니면 최소한 각 메모리 도메인마다 하나의 rx queue를 설정하는 것이 보통이다.</p>

<h2 id="vpp">VPP</h2>


          <p class="tags">
            
              <a href="/tags#rss-ref">RSS</a>
            
              <a href="/tags#receive-side-scaling-ref">Receive Side Scaling</a>
            
              <a href="/tags#performance-ref">performance</a>
            
              <a href="/tags#multiqueue-ref">multiqueue</a>
            
          </p>
        </section>
        <footer class="post-footer">
          <section class="share">
            <div class="fb-like" data-href="http://cwyang.github.io/2023/02/08/Receive-Side-Scaling.html" data-layout="button_count" data-action="like" data-show-faces="true" data-share="true"></div>
            
              
                <a class="icon-facebook" href="https://www.facebook.com/sharer.php?t=Azure+VNET+%EB%9D%BC%EC%9A%B0%ED%8C%85&amp;u=http://cwyang.github.io/2023/02/08/Receive-Side-Scaling"
                  onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
                <i class="fa fa-facebook"></i><span class="hidden">facebook</span>
                </a>
              
            
              
                <a class="icon-twitter" href="http://twitter.com/share?text=Azure+VNET+%EB%9D%BC%EC%9A%B0%ED%8C%85&amp;url=http://cwyang.github.io/2023/02/08/Receive-Side-Scaling"
                  onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
                <i class="fa fa-twitter"></i><span class="hidden">twitter</span>
                </a>
              
            
          </section>
        </footer>
        <div class="bottom-teaser cf">
          <div class="isLeft">
            <h5 class="index-headline featured"><span>Written by</span></h5>
            <section class="author">
              <div class="author-image" style="background-image: url(/assets/images/author.jpg)">Blog Logo</div>
              <h4>양철웅</h4>
              <p class="bio">Chul-Woong Yang</p>
              <hr>
              <p class="published">Published <time datetime="2023-02-08 20:00">08 Feb 2023</time></p>
            </section>
          </div>

          <div class="isRight">
            <h5 class="index-headline featured"><span>Supported by</span></h5>
            <footer class="site-footer">
              <section class="poweredby">Proudly published with <a href="http://jekyllrb.com"> Jekyll</a></section>
              <a class="subscribe" href="/feed.xml"> <span class="tooltip"> <i class="fa fa-rss"></i> RSS 구독하기</span></a><br />
              
            </footer>
          </div>
        </div>

         
        <div class="fb-comments-wrapper">
          
            <div class="fb-comments" data-href="http://cwyang.github.io/2023/02/08/Receive-Side-Scaling.html" data-num-posts="5" data-order-by="social" data-width="100%"></div>
          
        </div>
        

        
      </article>
    </main>

    <aside class="read-next">
      
        <a class="read-next-story no-cover" href="/2023/03/26/linux-settings.html">
          <section class="post">
            <h2>Linux Settings in 2023</h2>
            <p>잠시 사용하던 윈도우에서 다시 리눅스로 돌아가고자 한다. 랩탑에 설치하는 것은 처음이다. 윈도우와 최대한 유사하게 꾸며보기로...</p>
          </section>
        </a>
      
      
        <a class="read-next-story prev no-cover" href="/2023/02/08/Azure-VNET-routing.html">
          <section class="post">
            <h2>Azure VNET 라우팅</h2>
            <p>Azure의 VNET(Virtual Network)은 클라우드상의 네트워크 환경이다. AWS의 VPC (Virtual Private Cloud)에 대응한다. VNET에 할당된 주소범위(CIDR)를...</p>
          </section>
        </a>
      
    </aside>
    <footer class="post-site-footer clearfix">
      <section class="copyright"><a href="/">양철웅의 DX 이야기</a> © 2023</section>
    </footer>

    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/assets/js/index.js?1689503527012810482"></script>
<script type="text/javascript" src="/assets/js/readingtime.js"></script>
<script type="text/javascript" src="/assets/js/asciinema-player.js"></script>
<script>
(function ($) {
  "use strict";
  $(document).ready(function(){

    var $window = $(window),
    $image = $('.post-image-image, .teaserimage-image');

      $window.on('scroll', function() {
        var top = $window.scrollTop();

        if (top < 0 || top > 1500) { return; }
        $image
          .css('transform', 'translate3d(0px, '+top/3+'px, 0px)')
          .css('opacity', 1-Math.max(top/700, 0));
      });
      $window.trigger('scroll');

      var height = $('.article-image').height();
      $('.post-content').css('padding-top', height + 'px');

      $('a[href*=#]:not([href=#])').click(function() {
        if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'')
         && location.hostname == this.hostname) {
          var target = $(this.hash);
          target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
          if (target.length) {
            $('html,body').animate({ scrollTop: target.offset().top }, 500);
            return false;
          }
        }
      });

  });
}(jQuery));
</script>

  </body>
</html>
